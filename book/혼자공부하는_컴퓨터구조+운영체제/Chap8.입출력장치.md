# 입출력장치

## 장치 컨트롤러 
입출력 장치는 CPU, 메모리보다 까다로운 특성을 가지고 있다.

1. 입출력장치의 종류가 너무나도 많다.
2. 일반적으로 CPU와 메모리의 데이터 전송률은 높지만 입출력장치의 데이터 전송률은 낮다.

입출력장치는 CPU나 메모리와 전송률이 비슷하지 않기 때문에 같은 어려움을 겪게된다. 

이와 같은 이유로 입출력장치는 컴퓨터에 장치 컨틀롤러는 `입출력 제어기`(I/O Controller), `입출력 모듈`(I/O module)등으로 다양하게 불리기도 한다. 

장치 컨트롤러는 대표적으로 다음과 같은 역할을 통해 앞에서 언급한 문제들을 해결한다. 

* CPU와 입출력장치 간의 통신 중개
* 오류 검출
* 데이터 버퍼링


장치 컨트롤러의 세 번째 기능인 `데이터 버퍼링`은 무엇일까? 
`버퍼링`이란 전송률이 높은 장치와 낮은 장치 사이에 주고받는 데이터를 `버퍼`라는 임시 저장 공간에 저장하여 전송률을 비슷하게 맞추는 방법이다.(= 버퍼에 데이터를 조금씩 모았다가 한꺼번에 전송 or 데이터를 한 번에 많이 받아 조금씩 내보내는 방법)
장치 컨트롤러는 일반적으로 전송률이 높은 CPU와 일반적으로 전송률이 낮은 입출력장치와의 전송률 차이를 데이터 버퍼링으로 완화한다.

장치 컨트롤러 내부는 3가지 레스터로 구성되어있다.  
* 데이터 레지스터: CPU와 입출력장치 사이에 주고받을 데이터가 담기는 레지스터이다. (데이터 레지스터가 버퍼 역할을 한다)
* 상태 레지스터: 입출력장치가 입출력 작업을 할 준비가 되었는지, 입출력 작업이 완료되었는지, 입출력장치에 오류는 없는지 등의 상태 정보가 저장된다.
* 제어 레지스터: 입출력장치가 수행할 내용에 대한 제어 정보와 명령을 저장한다. 

## 장치 드라이버

> 장치 드라이버란 장치 컨트롤러의 동작을 감지하고 제어함으로써 장치 컨트롤러가 컴퓨터 내부와 정보를 주고받을 수 있게하는 프로그램이다.
> 프로그램이기에 당연히 실행 과정에서 메모리에 저장된다. 
> 장치 컨트롤러가 입출력 장치를 연결하기 위한 하드웨어적인 통로라면, 장치 드라이버는 입출력장치를 연결하기 위한 소프트웨어적인 통로이다.

## 다양한 입출력 방법

입출력 작업을 수행하려면 크게 세 가지 방법이 있다. 
1. 프로그램 입출력: 프로그램 속 명령어로 입출력장치를 제어하는 방법 (CPU가 여러 장치 컨트롤러 속 레지스터들을 아는 방식: (1)메모리 맵 입출력, (2)고립형 입출력)
2. 인터럽트 기반 입출력: 장치 컨트롤러에 의해 발생한다. CPU는 장치 컨트롤러에 입출력 작업을 명령하고, 장치 컨트롤러가 입출력장치를 제어하며 입출력을 수행하는 동안 CPU는 다른 일을 할 수 있다.
   * PIC(Programmable Interrupt Controller)를 통해 인터럽트를 관리한다.
3. DMA 입출력: 앞의 두 케이스는 데이터 이동은 CPU가 주도하고, 이동하는 데이터도 반드시 CPU를 거친다는 공통점이있지만, DMA는 입출력장치와 메모리가 CPU를 거치지 않고도 상호작용할 수 있는 입출력 방식이다.
   * DMA 입출력을 하기 위해서는 시스템 버스에 연결된 `DMA 컨트롤러`라는 하드웨어가 필요하다. 

(인터럽트와 자주 비교되는 개념이 '폴링'이다. 폴링은 CPU가 장치 컨트롤러에게 계속 물어보는 방식이다. 장치 컨트롤러가 입출력 작업을 수행할 준비가 되었는지 계속 물어보는 방식이 CPU의 부담이 크다)

